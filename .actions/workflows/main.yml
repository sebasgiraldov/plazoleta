name: Build & Deploy Spring app

on:
  push:
    branches:
      - main

  jobs:
    build-deploy:
      name: Build and Deploy Plazoleta
      runs-on: ubuntu-latest
      steps:
        - name: Checkout code
          uses: actions/checkout@3

        - name: Setup JDK 17
          uses: actions/setup-java@v3
          with:
            distribution: 'corretto'
            java-version: 17

        - name: Build and analyze
          env:
            GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # Needed to get PR information, if any
            SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
          run: ./gradlew build sonar --info